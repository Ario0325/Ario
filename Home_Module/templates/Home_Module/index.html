{% extends 'shared/base.html' %}
{% load static %}

{% block title %}صفحه اصلی{% endblock %}

{% block content %}
<div class="intro-slider-container mb-3 mb-lg-5">
    <div class="intro-slider owl-carousel owl-simple owl-nav-inside owl-light" data-toggle="owl"
        data-owl-options='{"nav":false, "dots": false, "loop": false}'>
        <div class="intro-slide"
            style="background-image: url({% static 'assets/images/demos/demo-12/slider/slide-1.jpg' %});">
            <div class="container intro-content text-center">
                <h3 class="intro-subtitle text-white">پیشنهادهای جدید</h3>
                <h1 class="intro-title text-white">این فرصت را از دست ندهید</h1>

                <a href="{% url 'products:list' %}" class="btn btn-outline-white">
                    <span>مشاهده محصولات</span>
                    <i class="icon-long-arrow-left"></i>
                </a>
            </div>
        </div>
    </div>

    <span class="slider-loader text-white"></span>
</div>

<div class="container">
    <div class="row">
        <div class="col-md-6">
            <div class="banner banner-display banner-link-anim banner-title-hidden">
                <a href="{% url 'products:list' %}">
                    <img src="{% static 'assets/images/demos/demo-12/banners/banner-1.jpg' %}" alt="Banner">
                </a>

                <div class="banner-content banner-content-center">
                    <h3 class="banner-title text-white text-center"><a href="{% url 'products:list' %}">این هفته با بهترین تخفیف‌ها</a></h3>
                    <a href="{% url 'products:list' %}" class="btn btn-outline-white banner-link">خرید</a>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="banner banner-display banner-link-anim banner-title-hidden">
                <a href="{% url 'products:list' %}">
                    <img src="{% static 'assets/images/demos/demo-12/banners/banner-2.jpg' %}" alt="Banner">
                </a>

                <div class="banner-content banner-content-center">
                    <h3 class="banner-title text-white text-center"><a href="{% url 'products:list' %}">کیف‌های جدید</a></h3>
                    <a href="{% url 'products:list' %}" class="btn btn-outline-white banner-link">مشاهده</a>
                </div>
            </div>
            <div class="banner banner-display banner-link-anim banner-title-hidden">
                <a href="{% url 'products:list' %}">
                    <img src="{% static 'assets/images/demos/demo-12/banners/banner-3.jpg' %}" alt="Banner">
                </a>

                <div class="banner-content banner-content-center">
                    <h3 class="banner-title text-white text-center"><a href="{% url 'products:list' %}">محصولات برتر</a></h3>
                    <a href="{% url 'products:list' %}" class="btn btn-outline-white banner-link">خرید</a>
                </div>
            </div>
        </div>
    </div>

    <div class="mb-3"></div>
</div>

<div class="bg-lighter pt-5 pb-5 mb-5">
    <div class="container">
        <div class="heading text-center mb-4">
            <h2 class="title">محصولات جدید</h2>
            <p class="title-desc">جدیدترین محصولات ما</p>
        </div>

        <div class="owl-carousel owl-simple" data-toggle="owl" data-owl-options='{
            "nav": false,
            "dots": true,
            "margin": 20,
            "loop": false,
            "rtl": true,
            "responsive": {
                "0": {"items":2},
                "480": {"items":2},
                "768": {"items":3},
                "992": {"items":4},
                "1200": {"items":4, "nav": true}
            }
        }'>
            {% for product in new_products %}
            <div class="product product-4">
                <figure class="product-media">
                    {% if product.label %}
                    <span class="product-label label-{{ product.label }}">{{ product.get_label_display }}</span>
                    {% endif %}

                    <a href="{% url 'products:detail' product.slug %}">
                        {% with product.images.all.0 as main_image %}
                        {% if main_image %}
                            <img src="{{ main_image.image.url }}" alt="{{ product.name }}" class="product-image">
                        {% else %}
                            <img src="{% static 'assets/images/products/product-1.jpg' %}" alt="{{ product.name }}" class="product-image">
                        {% endif %}
                        {% endwith %}

                        {% if product.images.all.1 %}
                            <img src="{{ product.images.all.1.image.url }}" alt="{{ product.name }}" class="product-image-hover">
                        {% endif %}
                    </a>

                    <div class="product-action-vertical">
                        <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>افزودن به لیست علاقه مندی</span></a>
                        <a href="{% url 'products:detail' product.slug %}" class="btn-product-icon btn-quickview" title="مشاهده سریع"><span>مشاهده سریع</span></a>
                        <a href="#" class="btn-product-icon btn-compare" title="مقایسه"><span>مقایسه</span></a>
                    </div>

                    <div class="product-action">
                        <a href="#" class="btn-product btn-cart"><span>افزودن به سبد خرید</span></a>
                    </div>
                </figure>

                <div class="product-body">
                    <div class="product-cat">
                        <a href="{% url 'products:category' product.category.slug %}">{{ product.category.name }}</a>
                    </div>
                    <h3 class="product-title"><a href="{% url 'products:detail' product.slug %}">{{ product.name }}</a></h3>
                    <div class="product-price">
                        {% if product.old_price %}
                            <span class="new-price">{{ product.price|floatformat:0 }} تومان</span>
                            <span class="old-price">{{ product.old_price|floatformat:0 }} تومان</span>
                        {% else %}
                            {{ product.price|floatformat:0 }} تومان
                        {% endif %}
                    </div>
                    <div class="ratings-container">
                        <div class="ratings">
                            <div class="ratings-val" style="width: {{ product.get_rating_percentage }}%;"></div>
                        </div>
                        <span class="ratings-text">( {{ product.views_count }} بازدید )</span>
                    </div>
                    {% if product.colors.exists %}
                    <div class="product-nav product-nav-dots">
                        {% for color in product.colors.all|slice:":3" %}
                        <a href="#" {% if forloop.first %}class="active"{% endif %} style="background: {{ color.code }};"><span class="sr-only">{{ color.name }}</span></a>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <p class="text-center">محصولی یافت نشد</p>
            {% endfor %}
        </div>
    </div>
</div>

<div class="bg-light pt-5 pb-4 mb-5">
    <div class="container">
        <div class="heading text-center mb-4">
            <h2 class="title">محصولات پرفروش</h2>
            <p class="title-desc">محصولات محبوب مشتریان ما</p>
        </div>

        <div class="owl-carousel owl-simple" data-toggle="owl" data-owl-options='{
            "nav": false,
            "dots": true,
            "margin": 20,
            "loop": false,
            "rtl": true,
            "responsive": {
                "0": {"items":2},
                "480": {"items":2},
                "768": {"items":3},
                "992": {"items":4},
                "1200": {"items":4, "nav": true}
            }
        }'>
            {% for product in trending_products %}
            <div class="product product-4">
                <figure class="product-media">
                    {% if not product.is_available or product.stock <= 0 %}
                    <span class="product-label label-out">ناموجود</span>
                    {% elif product.label %}
                    <span class="product-label label-{{ product.label }}">{{ product.get_label_display }}</span>
                    {% endif %}

                    <a href="{% url 'products:detail' product.slug %}">
                        {% with product.images.all.0 as main_image %}
                        {% if main_image %}
                            <img src="{{ main_image.image.url }}" alt="{{ product.name }}" class="product-image">
                        {% else %}
                            <img src="{% static 'assets/images/products/product-1.jpg' %}" alt="{{ product.name }}" class="product-image">
                        {% endif %}
                        {% endwith %}

                        {% if product.images.all.1 %}
                            <img src="{{ product.images.all.1.image.url }}" alt="{{ product.name }}" class="product-image-hover">
                        {% endif %}
                    </a>

                    <div class="product-action-vertical">
                        <a href="#" class="btn-product-icon btn-wishlist btn-expandable"><span>افزودن به لیست علاقه مندی</span></a>
                        <a href="{% url 'products:detail' product.slug %}" class="btn-product-icon btn-quickview" title="مشاهده سریع"><span>مشاهده سریع</span></a>
                        <a href="#" class="btn-product-icon btn-compare" title="مقایسه"><span>مقایسه</span></a>
                    </div>

                    <div class="product-action">
                        {% if product.is_available and product.stock > 0 %}
                        <a href="#" class="btn-product btn-cart"><span>افزودن به سبد خرید</span></a>
                        {% else %}
                        <a href="{% url 'products:detail' product.slug %}" class="btn-product btn-cart"><span>مشاهده محصول</span></a>
                        {% endif %}
                    </div>
                </figure>

                <div class="product-body">
                    <div class="product-cat">
                        <a href="{% url 'products:category' product.category.slug %}">{{ product.category.name }}</a>
                    </div>
                    <h3 class="product-title"><a href="{% url 'products:detail' product.slug %}">{{ product.name }}</a></h3>
                    <div class="product-price">
                        {% if not product.is_available or product.stock <= 0 %}
                            <span class="out-price">{{ product.price|floatformat:0 }} تومان</span>
                        {% elif product.old_price %}
                            <span class="new-price">{{ product.price|floatformat:0 }} تومان</span>
                            <span class="old-price">{{ product.old_price|floatformat:0 }} تومان</span>
                        {% else %}
                            {{ product.price|floatformat:0 }} تومان
                        {% endif %}
                    </div>
                    <div class="ratings-container">
                        <div class="ratings">
                            <div class="ratings-val" style="width: {{ product.get_rating_percentage }}%;"></div>
                        </div>
                        <span class="ratings-text">( {{ product.views_count }} بازدید )</span>
                    </div>
                    {% if product.colors.exists %}
                    <div class="product-nav product-nav-dots">
                        {% for color in product.colors.all|slice:":3" %}
                        <a href="#" {% if forloop.first %}class="active"{% endif %} style="background: {{ color.code }};"><span class="sr-only">{{ color.name }}</span></a>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <p class="text-center">محصولی یافت نشد</p>
            {% endfor %}
        </div>
    </div>
</div>

<div class="container">
    <div class="heading text-center mb-4">
        <h2 class="title">دسته‌بندی‌های محصولات</h2>
        <p class="title-desc">خرید بر اساس دسته‌بندی</p>
    </div>

    <div class="row">
        {% for category in main_categories %}
        <div class="col-sm-6 col-lg-4">
            <div class="banner banner-display banner-link-anim">
                <a href="{% url 'products:category' category.slug %}">
                    {% if category.image %}
                        <img src="{{ category.image.url }}" alt="{{ category.name }}">
                    {% else %}
                        <img src="{% static 'assets/images/demos/demo-12/banners/banner-4.jpg' %}" alt="{{ category.name }}">
                    {% endif %}
                </a>

                <div class="banner-content banner-content-center">
                    <h3 class="banner-title text-white text-center">
                        <a href="{% url 'products:category' category.slug %}">{{ category.name }}</a>
                    </h3>
                    <h4 class="banner-subtitle text-white text-center">
                        <a href="{% url 'products:category' category.slug %}">{{ category.products_count }} محصول</a>
                    </h4>
                    <a href="{% url 'products:category' category.slug %}" class="btn btn-outline-white banner-link">خرید</a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="icon-boxes-container bg-transparent">
        <div class="container">
            <div class="row">
                <div class="col-sm-6 col-lg-3">
                    <div class="icon-box icon-box-side">
                        <span class="icon-box-icon">
                            <i class="icon-rocket"></i>
                        </span>
                        <div class="icon-box-content mr-1">
                            <h3 class="icon-box-title">ارسال رایگان</h3>
                            <p>برای سفارشات بالای 50 هزار تومان</p>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-lg-3">
                    <div class="icon-box icon-box-side">
                        <span class="icon-box-icon">
                            <i class="icon-rotate-left"></i>
                        </span>

                        <div class="icon-box-content mr-1">
                            <h3 class="icon-box-title">بازگرداندن رایگان</h3>
                            <p>تا 30 روز بعد از خرید</p>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-lg-3">
                    <div class="icon-box icon-box-side">
                        <span class="icon-box-icon">
                            <i class="icon-info-circle"></i>
                        </span>

                        <div class="icon-box-content mr-1">
                            <h3 class="icon-box-title">20% تخفیف برای اولین خرید</h3>
                            <p>کافیست ثبت نام کنید</p>
                        </div>
                    </div>
                </div>

                <div class="col-sm-6 col-lg-3">
                    <div class="icon-box icon-box-side">
                        <span class="icon-box-icon">
                            <i class="icon-life-ring"></i>
                        </span>

                        <div class="icon-box-content mr-1">
                            <h3 class="icon-box-title">پشتیبانی حرفه ای</h3>
                            <p>خدمات حرفه ای 24 ساعته/7روز هفته</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
    <!-- اسکریپت‌های خاص صفحه اصلی -->
{% endblock %}